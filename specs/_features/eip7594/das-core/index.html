
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ethereum.github.io/consensus-specs/specs/_features/eip7594/das-core/">
      
      
        <link rel="prev" href="../../eip6914/fork-choice/">
      
      
        <link rel="next" href="../fork/">
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.5">
    
    
      
        <title>EIP-7594 -- Data Availability Sampling Core - Ethereum Consensus Specs</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.7a7fce14.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#eip-7594-data-availability-sampling-core" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Ethereum Consensus Specs" class="md-header__button md-logo" aria-label="Ethereum Consensus Specs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ethereum Consensus Specs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              EIP-7594 -- Data Availability Sampling Core
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../phase0/beacon-chain/" class="md-tabs__link md-tabs__link--active">
        Specs
      </a>
    </li>
  

  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../docs/new-feature/" class="md-tabs__link">
        Docs
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../fork_choice/safe-block/" class="md-tabs__link">
        Fork choice
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../light-client/" class="md-tabs__link">
        Light client
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../ssz/merkle-proofs/" class="md-tabs__link">
        Ssz
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../sync/optimistic/" class="md-tabs__link">
        Sync
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Ethereum Consensus Specs" class="md-nav__button md-logo" aria-label="Ethereum Consensus Specs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Ethereum Consensus Specs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Ethereum Proof-of-Stake Consensus Specifications
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Specs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Specs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          Phase0
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          Phase0
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/beacon-chain/" class="md-nav__link">
        Phase 0 -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/deposit-contract/" class="md-nav__link">
        Phase 0 -- Deposit Contract
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/fork-choice/" class="md-nav__link">
        Phase 0 -- Beacon Chain Fork Choice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/p2p-interface/" class="md-nav__link">
        Phase 0 -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/validator/" class="md-nav__link">
        Phase 0 -- Honest Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/weak-subjectivity/" class="md-nav__link">
        Phase 0 -- Weak Subjectivity Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Altair
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Altair
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/beacon-chain/" class="md-nav__link">
        Altair -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/bls/" class="md-nav__link">
        Altair -- BLS extensions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/fork/" class="md-nav__link">
        Altair -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/p2p-interface/" class="md-nav__link">
        Altair -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/validator/" class="md-nav__link">
        Altair -- Honest Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
          Light client
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_6">
          <span class="md-nav__icon md-icon"></span>
          Light client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/light-client/full-node/" class="md-nav__link">
        Altair Light Client -- Full Node
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/light-client/light-client/" class="md-nav__link">
        Altair Light Client -- Light Client
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/light-client/p2p-interface/" class="md-nav__link">
        Altair Light Client -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/light-client/sync-protocol/" class="md-nav__link">
        Altair Light Client -- Sync Protocol
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          Bellatrix
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_3">
          <span class="md-nav__icon md-icon"></span>
          Bellatrix
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bellatrix/beacon-chain/" class="md-nav__link">
        Bellatrix -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bellatrix/fork-choice/" class="md-nav__link">
        Bellatrix -- Fork Choice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bellatrix/fork/" class="md-nav__link">
        Bellatrix -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bellatrix/p2p-interface/" class="md-nav__link">
        Bellatrix -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bellatrix/validator/" class="md-nav__link">
        Bellatrix -- Honest Validator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          Capella
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Capella
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/beacon-chain/" class="md-nav__link">
        Capella -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/fork-choice/" class="md-nav__link">
        Capella -- Fork Choice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/fork/" class="md-nav__link">
        Capella -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/p2p-interface/" class="md-nav__link">
        Capella -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/validator/" class="md-nav__link">
        Capella -- Honest Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4_6" id="__nav_2_4_6_label" tabindex="0">
          Light client
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4_6">
          <span class="md-nav__icon md-icon"></span>
          Light client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/light-client/fork/" class="md-nav__link">
        Capella Light Client -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/light-client/full-node/" class="md-nav__link">
        Capella Light Client -- Full Node
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/light-client/p2p-interface/" class="md-nav__link">
        Capella Light Client -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/light-client/sync-protocol/" class="md-nav__link">
        Capella Light Client -- Sync Protocol
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          Deneb
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Deneb
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/beacon-chain/" class="md-nav__link">
        Deneb -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/fork-choice/" class="md-nav__link">
        Deneb -- Fork Choice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/fork/" class="md-nav__link">
        Deneb -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/p2p-interface/" class="md-nav__link">
        Deneb -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/polynomial-commitments/" class="md-nav__link">
        Deneb -- Polynomial Commitments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/validator/" class="md-nav__link">
        Deneb -- Honest Validator
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5_7" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5_7" id="__nav_2_5_7_label" tabindex="0">
          Light client
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_5_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5_7">
          <span class="md-nav__icon md-icon"></span>
          Light client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/light-client/fork/" class="md-nav__link">
        Deneb Light Client -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/light-client/full-node/" class="md-nav__link">
        Deneb Light Client -- Full Node
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/light-client/p2p-interface/" class="md-nav__link">
        Deneb Light Client -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/light-client/sync-protocol/" class="md-nav__link">
        Deneb Light Client -- Sync Protocol
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Electra
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Electra
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../electra/beacon-chain/" class="md-nav__link">
        Electra -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../electra/fork/" class="md-nav__link">
        Electra -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../electra/p2p-interface/" class="md-nav__link">
        Electra -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../electra/validator/" class="md-nav__link">
        Electra -- Honest Validator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
           features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
           features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7_1" id="__nav_2_7_1_label" tabindex="0">
          Custody game
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7_1">
          <span class="md-nav__icon md-icon"></span>
          Custody game
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../custody_game/beacon-chain/" class="md-nav__link">
        Custody Game -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../custody_game/validator/" class="md-nav__link">
        Custody Game -- Honest Validator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7_2" id="__nav_2_7_2_label" tabindex="0">
          Das
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7_2">
          <span class="md-nav__icon md-icon"></span>
          Das
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../das/das-core/" class="md-nav__link">
        Data Availability Sampling -- Core
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../das/fork-choice/" class="md-nav__link">
        Data Availability Sampling -- Fork Choice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../das/p2p-interface/" class="md-nav__link">
        Data Availability Sampling -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../das/sampling/" class="md-nav__link">
        Data Availability Sampling -- Sampling
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7_3" id="__nav_2_7_3_label" tabindex="0">
          Eip6914
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7_3">
          <span class="md-nav__icon md-icon"></span>
          Eip6914
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../eip6914/beacon-chain/" class="md-nav__link">
        EIP-6914 -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../eip6914/fork-choice/" class="md-nav__link">
        EIP-6914 -- Fork Choice
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_4" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_7_4" id="__nav_2_7_4_label" tabindex="0">
          Eip7594
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_7_4">
          <span class="md-nav__icon md-icon"></span>
          Eip7594
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          EIP-7594 -- Data Availability Sampling Core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        EIP-7594 -- Data Availability Sampling Core
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    Constants
  </a>
  
    <nav class="md-nav" aria-label="Constants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    Misc
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-types" class="md-nav__link">
    Custom types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-size" class="md-nav__link">
    Data size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networking" class="md-nav__link">
    Networking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custody-setting" class="md-nav__link">
    Custody setting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containers" class="md-nav__link">
    Containers
  </a>
  
    <nav class="md-nav" aria-label="Containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datacolumnsidecar" class="md-nav__link">
    DataColumnSidecar
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    Helper functions
  </a>
  
    <nav class="md-nav" aria-label="Helper functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_custody_columns" class="md-nav__link">
    get_custody_columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_extended_matrix" class="md-nav__link">
    compute_extended_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recover_matrix" class="md-nav__link">
    recover_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_data_column_sidecars" class="md-nav__link">
    get_data_column_sidecars
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custody" class="md-nav__link">
    Custody
  </a>
  
    <nav class="md-nav" aria-label="Custody">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custody-requirement" class="md-nav__link">
    Custody requirement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-deterministic-selection" class="md-nav__link">
    Public, deterministic selection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peer-discovery" class="md-nav__link">
    Peer discovery
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extended-data" class="md-nav__link">
    Extended data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#column-gossip" class="md-nav__link">
    Column gossip
  </a>
  
    <nav class="md-nav" aria-label="Column gossip">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peer-sampling" class="md-nav__link">
    Peer sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peer-scoring" class="md-nav__link">
    Peer scoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconstruction-and-cross-seeding" class="md-nav__link">
    Reconstruction and cross-seeding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#das-providers" class="md-nav__link">
    DAS providers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-note-on-fork-choice" class="md-nav__link">
    A note on fork choice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    FAQs
  </a>
  
    <nav class="md-nav" aria-label="FAQs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#row-blob-custody" class="md-nav__link">
    Row (blob) custody
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subnet-stability" class="md-nav__link">
    Subnet stability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fork/" class="md-nav__link">
        EIP7594 -- Fork Logic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../p2p-interface/" class="md-nav__link">
        EIP-7594 -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../polynomial-commitments-sampling/" class="md-nav__link">
        EIP-7594 -- Polynomial Commitments
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_5" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7_5" id="__nav_2_7_5_label" tabindex="0">
          Sharding
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7_5">
          <span class="md-nav__icon md-icon"></span>
          Sharding
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sharding/beacon-chain/" class="md-nav__link">
        Sharding -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sharding/p2p-interface/" class="md-nav__link">
        Sharding -- Networking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sharding/polynomial-commitments/" class="md-nav__link">
        Sharding -- Polynomial Commitments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sharding/validator/" class="md-nav__link">
        Sharding -- Honest Validator
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7_6" id="__nav_2_7_6_label" tabindex="0">
          Whisk
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_7_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7_6">
          <span class="md-nav__icon md-icon"></span>
          Whisk
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../whisk/beacon-chain/" class="md-nav__link">
        Whisk -- The Beacon Chain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../whisk/fork/" class="md-nav__link">
        Whisk -- Fork Logic
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/new-feature/" class="md-nav__link">
        How to add a new feature proposal in consensus-specs
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Templates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Templates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/templates/beacon-chain-template/" class="md-nav__link">
        `beacon-chain.md` Template
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Fork choice
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Fork choice
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../fork_choice/safe-block/" class="md-nav__link">
        Fork Choice -- Safe Block
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
      
      
      
        <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          Fork Choice -- Core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Fork Choice -- Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../phase0/fork-choice" class="md-nav__link">
        phase0
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../bellatrix/fork-choice" class="md-nav__link">
        bellatrix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/fork-choice" class="md-nav__link">
        capella
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/fork-choice" class="md-nav__link">
        deneb
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Light client
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Light client
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../light-client/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../altair/light-client/sync-protocol" class="md-nav__link">
        Altair
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../capella/light-client/sync-protocol" class="md-nav__link">
        Capella
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../deneb/light-client/sync-protocol" class="md-nav__link">
        Deneb
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Ssz
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Ssz
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ssz/merkle-proofs/" class="md-nav__link">
        Merkle proof formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../ssz/simple-serialize/" class="md-nav__link">
        SimpleSerialize (SSZ)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Sync
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Sync
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../sync/optimistic/" class="md-nav__link">
        Optimistic Sync
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constants" class="md-nav__link">
    Constants
  </a>
  
    <nav class="md-nav" aria-label="Constants">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#misc" class="md-nav__link">
    Misc
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-types" class="md-nav__link">
    Custom types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    Configuration
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#data-size" class="md-nav__link">
    Data size
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#networking" class="md-nav__link">
    Networking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custody-setting" class="md-nav__link">
    Custody setting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containers" class="md-nav__link">
    Containers
  </a>
  
    <nav class="md-nav" aria-label="Containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#datacolumnsidecar" class="md-nav__link">
    DataColumnSidecar
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    Helper functions
  </a>
  
    <nav class="md-nav" aria-label="Helper functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get_custody_columns" class="md-nav__link">
    get_custody_columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compute_extended_matrix" class="md-nav__link">
    compute_extended_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recover_matrix" class="md-nav__link">
    recover_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_data_column_sidecars" class="md-nav__link">
    get_data_column_sidecars
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custody" class="md-nav__link">
    Custody
  </a>
  
    <nav class="md-nav" aria-label="Custody">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#custody-requirement" class="md-nav__link">
    Custody requirement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#public-deterministic-selection" class="md-nav__link">
    Public, deterministic selection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peer-discovery" class="md-nav__link">
    Peer discovery
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extended-data" class="md-nav__link">
    Extended data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#column-gossip" class="md-nav__link">
    Column gossip
  </a>
  
    <nav class="md-nav" aria-label="Column gossip">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peer-sampling" class="md-nav__link">
    Peer sampling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#peer-scoring" class="md-nav__link">
    Peer scoring
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconstruction-and-cross-seeding" class="md-nav__link">
    Reconstruction and cross-seeding
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#das-providers" class="md-nav__link">
    DAS providers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-note-on-fork-choice" class="md-nav__link">
    A note on fork choice
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    FAQs
  </a>
  
    <nav class="md-nav" aria-label="FAQs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#row-blob-custody" class="md-nav__link">
    Row (blob) custody
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subnet-stability" class="md-nav__link">
    Subnet stability
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="eip-7594-data-availability-sampling-core">EIP-7594 -- Data Availability Sampling Core<a class="headerlink" href="#eip-7594-data-availability-sampling-core" title="Permanent link">&para;</a></h1>
<p><strong>Notice</strong>: This document is a work-in-progress for researchers and implementers.</p>
<h2 id="table-of-contents">Table of contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<!-- TOC -->
<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

<ul>
<li><a href="#constants">Constants</a></li>
<li><a href="#misc">Misc</a></li>
<li><a href="#custom-types">Custom types</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#data-size">Data size</a></li>
<li><a href="#networking">Networking</a></li>
<li><a href="#custody-setting">Custody setting</a></li>
<li><a href="#containers">Containers</a><ul>
<li><a href="#datacolumnsidecar"><code>DataColumnSidecar</code></a></li>
</ul>
</li>
<li><a href="#helper-functions">Helper functions</a><ul>
<li><a href="#get_custody_columns"><code>get_custody_columns</code></a></li>
<li><a href="#compute_extended_matrix"><code>compute_extended_matrix</code></a></li>
<li><a href="#recover_matrix"><code>recover_matrix</code></a></li>
<li><a href="#get_data_column_sidecars"><code>get_data_column_sidecars</code></a></li>
</ul>
</li>
<li><a href="#custody">Custody</a></li>
<li><a href="#custody-requirement">Custody requirement</a></li>
<li><a href="#public-deterministic-selection">Public, deterministic selection</a></li>
<li><a href="#peer-discovery">Peer discovery</a></li>
<li><a href="#extended-data">Extended data</a></li>
<li><a href="#column-gossip">Column gossip</a></li>
<li><a href="#parameters">Parameters</a></li>
<li><a href="#peer-sampling">Peer sampling</a></li>
<li><a href="#peer-scoring">Peer scoring</a></li>
<li><a href="#reconstruction-and-cross-seeding">Reconstruction and cross-seeding</a></li>
<li><a href="#das-providers">DAS providers</a></li>
<li><a href="#a-note-on-fork-choice">A note on fork choice</a></li>
<li><a href="#faqs">FAQs</a></li>
<li><a href="#row-blob-custody">Row (blob) custody</a></li>
<li><a href="#subnet-stability">Subnet stability</a></li>
</ul>
<!-- END doctoc generated TOC please keep comment here to allow auto update -->
<!-- /TOC -->

<h2 id="constants">Constants<a class="headerlink" href="#constants" title="Permanent link">&para;</a></h2>
<p>The following values are (non-configurable) constants used throughout the specification.</p>
<h3 id="misc">Misc<a class="headerlink" href="#misc" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>UINT256_MAX</code></td>
<td><code>uint256(2**256 - 1)</code></td>
</tr>
</tbody>
</table>
<h2 id="custom-types">Custom types<a class="headerlink" href="#custom-types" title="Permanent link">&para;</a></h2>
<p>We define the following Python custom types for type hinting and readability:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>SSZ equivalent</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DataColumn</code></td>
<td><code>List[Cell, MAX_BLOB_COMMITMENTS_PER_BLOCK]</code></td>
<td>The data of each column in EIP-7594</td>
</tr>
<tr>
<td><code>ExtendedMatrix</code></td>
<td><code>List[Cell, MAX_CELLS_IN_EXTENDED_MATRIX]</code></td>
<td>The full data of one-dimensional erasure coding extended blobs (in row major format).</td>
</tr>
</tbody>
</table>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">&para;</a></h2>
<h3 id="data-size">Data size<a class="headerlink" href="#data-size" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NUMBER_OF_COLUMNS</code></td>
<td><code>uint64(CELLS_PER_EXT_BLOB)</code> (= 128)</td>
<td>Number of columns in the extended data matrix.</td>
</tr>
<tr>
<td><code>MAX_CELLS_IN_EXTENDED_MATRIX</code></td>
<td><code>uint64(MAX_BLOBS_PER_BLOCK * NUMBER_OF_COLUMNS)</code> (= 768)</td>
<td>The data size of <code>ExtendedMatrix</code>.</td>
</tr>
</tbody>
</table>
<h3 id="networking">Networking<a class="headerlink" href="#networking" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DATA_COLUMN_SIDECAR_SUBNET_COUNT</code></td>
<td><code>32</code></td>
<td>The number of data column sidecar subnets used in the gossipsub protocol</td>
</tr>
</tbody>
</table>
<h3 id="custody-setting">Custody setting<a class="headerlink" href="#custody-setting" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SAMPLES_PER_SLOT</code></td>
<td><code>8</code></td>
<td>Number of <code>DataColumn</code> random samples a node queries per slot</td>
</tr>
<tr>
<td><code>CUSTODY_REQUIREMENT</code></td>
<td><code>1</code></td>
<td>Minimum number of subnets an honest node custodies and serves samples from</td>
</tr>
<tr>
<td><code>TARGET_NUMBER_OF_PEERS</code></td>
<td><code>70</code></td>
<td>Suggested minimum peer count</td>
</tr>
</tbody>
</table>
<h3 id="containers">Containers<a class="headerlink" href="#containers" title="Permanent link">&para;</a></h3>
<h4 id="datacolumnsidecar"><code>DataColumnSidecar</code><a class="headerlink" href="#datacolumnsidecar" title="Permanent link">&para;</a></h4>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-1">1</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-2">2</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-3">3</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-4">4</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-5">5</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-6">6</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-0-7">7</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span style="color: #66d9ef">class</span> <span style="color: #a6e22e">DataColumnSidecar</span><span style="color: #f8f8f2">(Container):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span style="color: #f8f8f2">index:</span> <span style="color: #f8f8f2">ColumnIndex</span>  <span style="color: #959077"># Index of column in extended matrix</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>    <span style="color: #f8f8f2">column:</span> <span style="color: #f8f8f2">DataColumn</span>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span style="color: #f8f8f2">kzg_commitments:</span> <span style="color: #f8f8f2">List[KZGCommitment,</span> <span style="color: #f8f8f2">MAX_BLOB_COMMITMENTS_PER_BLOCK]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>    <span style="color: #f8f8f2">kzg_proofs:</span> <span style="color: #f8f8f2">List[KZGProof,</span> <span style="color: #f8f8f2">MAX_BLOB_COMMITMENTS_PER_BLOCK]</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>    <span style="color: #f8f8f2">signed_block_header:</span> <span style="color: #f8f8f2">SignedBeaconBlockHeader</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span style="color: #f8f8f2">kzg_commitments_inclusion_proof:</span> <span style="color: #f8f8f2">Vector[Bytes32,</span> <span style="color: #f8f8f2">KZG_COMMITMENTS_INCLUSION_PROOF_DEPTH]</span>
</code></pre></div></td></tr></table></div>
<h3 id="helper-functions">Helper functions<a class="headerlink" href="#helper-functions" title="Permanent link">&para;</a></h3>
<h4 id="get_custody_columns"><code>get_custody_columns</code><a class="headerlink" href="#get_custody_columns" title="Permanent link">&para;</a></h4>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-1"> 1</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-2"> 2</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-3"> 3</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-4"> 4</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-5"> 5</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-6"> 6</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-7"> 7</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-8"> 8</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-9"> 9</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-10">10</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-11">11</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-12">12</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-13">13</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-14">14</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-15">15</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-16">16</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-17">17</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-18">18</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-19">19</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-20">20</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-21">21</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-22">22</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-23">23</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-1-24">24</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">get_custody_columns</span><span style="color: #f8f8f2">(node_id:</span> <span style="color: #f8f8f2">NodeID,</span> <span style="color: #f8f8f2">custody_subnet_count:</span> <span style="color: #f8f8f2">uint64)</span> <span style="color: #ff4689">-&gt;</span> <span style="color: #f8f8f2">Sequence[ColumnIndex]:</span>
<a id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span style="color: #66d9ef">assert</span> <span style="color: #f8f8f2">custody_subnet_count</span> <span style="color: #ff4689">&lt;=</span> <span style="color: #f8f8f2">DATA_COLUMN_SIDECAR_SUBNET_COUNT</span>
<a id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4"></a>    <span style="color: #f8f8f2">subnet_ids</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[]</span>
<a id="__codelineno-1-5" name="__codelineno-1-5"></a>    <span style="color: #f8f8f2">i</span> <span style="color: #ff4689">=</span> <span style="color: #ae81ff">0</span>
<a id="__codelineno-1-6" name="__codelineno-1-6"></a>    <span style="color: #66d9ef">while</span> <span style="color: #f8f8f2">len(subnet_ids)</span> <span style="color: #ff4689">&lt;</span> <span style="color: #f8f8f2">custody_subnet_count:</span>
<a id="__codelineno-1-7" name="__codelineno-1-7"></a>        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">node_id</span> <span style="color: #ff4689">==</span> <span style="color: #f8f8f2">UINT256_MAX:</span>
<a id="__codelineno-1-8" name="__codelineno-1-8"></a>            <span style="color: #f8f8f2">node_id</span> <span style="color: #ff4689">=</span> <span style="color: #ae81ff">0</span>
<a id="__codelineno-1-9" name="__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10"></a>        <span style="color: #f8f8f2">subnet_id</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">(</span>
<a id="__codelineno-1-11" name="__codelineno-1-11"></a>            <span style="color: #f8f8f2">bytes_to_uint64(hash(uint_to_bytes(uint256(node_id</span> <span style="color: #ff4689">+</span> <span style="color: #f8f8f2">i)))[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">:</span><span style="color: #ae81ff">8</span><span style="color: #f8f8f2">])</span>
<a id="__codelineno-1-12" name="__codelineno-1-12"></a>            <span style="color: #ff4689">%</span> <span style="color: #f8f8f2">DATA_COLUMN_SIDECAR_SUBNET_COUNT</span>
<a id="__codelineno-1-13" name="__codelineno-1-13"></a>        <span style="color: #f8f8f2">)</span>
<a id="__codelineno-1-14" name="__codelineno-1-14"></a>        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">subnet_id</span> <span style="color: #ff4689">not</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">subnet_ids:</span>
<a id="__codelineno-1-15" name="__codelineno-1-15"></a>            <span style="color: #f8f8f2">subnet_ids</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">append(subnet_id)</span>
<a id="__codelineno-1-16" name="__codelineno-1-16"></a>        <span style="color: #f8f8f2">i</span> <span style="color: #ff4689">+=</span> <span style="color: #ae81ff">1</span>
<a id="__codelineno-1-17" name="__codelineno-1-17"></a>    <span style="color: #66d9ef">assert</span> <span style="color: #f8f8f2">len(subnet_ids)</span> <span style="color: #ff4689">==</span> <span style="color: #f8f8f2">len(set(subnet_ids))</span>
<a id="__codelineno-1-18" name="__codelineno-1-18"></a>
<a id="__codelineno-1-19" name="__codelineno-1-19"></a>    <span style="color: #f8f8f2">columns_per_subnet</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">NUMBER_OF_COLUMNS</span> <span style="color: #ff4689">//</span> <span style="color: #f8f8f2">DATA_COLUMN_SIDECAR_SUBNET_COUNT</span>
<a id="__codelineno-1-20" name="__codelineno-1-20"></a>    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">sorted([</span>
<a id="__codelineno-1-21" name="__codelineno-1-21"></a>        <span style="color: #f8f8f2">ColumnIndex(DATA_COLUMN_SIDECAR_SUBNET_COUNT</span> <span style="color: #ff4689">*</span> <span style="color: #f8f8f2">i</span> <span style="color: #ff4689">+</span> <span style="color: #f8f8f2">subnet_id)</span>
<a id="__codelineno-1-22" name="__codelineno-1-22"></a>        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(columns_per_subnet)</span>
<a id="__codelineno-1-23" name="__codelineno-1-23"></a>        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">subnet_id</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">subnet_ids</span>
<a id="__codelineno-1-24" name="__codelineno-1-24"></a>    <span style="color: #f8f8f2">])</span>
</code></pre></div></td></tr></table></div>
<h4 id="compute_extended_matrix"><code>compute_extended_matrix</code><a class="headerlink" href="#compute_extended_matrix" title="Permanent link">&para;</a></h4>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-1"> 1</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-2"> 2</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-3"> 3</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-4"> 4</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-5"> 5</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-6"> 6</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-7"> 7</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-8"> 8</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-9"> 9</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-10">10</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-2-11">11</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">compute_extended_matrix</span><span style="color: #f8f8f2">(blobs:</span> <span style="color: #f8f8f2">Sequence[Blob])</span> <span style="color: #ff4689">-&gt;</span> <span style="color: #f8f8f2">ExtendedMatrix:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span style="color: #f8f8f2">    </span><span style="color: #e6db74">&quot;&quot;&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span style="color: #e6db74">    Return the full ``ExtendedMatrix``.</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span style="color: #e6db74">    This helper demonstrates the relationship between blobs and ``ExtendedMatrix``.</span>
<a id="__codelineno-2-6" name="__codelineno-2-6"></a><span style="color: #e6db74">    The data structure for storing cells is implementation-dependent.</span>
<a id="__codelineno-2-7" name="__codelineno-2-7"></a><span style="color: #e6db74">    &quot;&quot;&quot;</span>
<a id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span style="color: #f8f8f2">extended_matrix</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[]</span>
<a id="__codelineno-2-9" name="__codelineno-2-9"></a>    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">blob</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">blobs:</span>
<a id="__codelineno-2-10" name="__codelineno-2-10"></a>        <span style="color: #f8f8f2">extended_matrix</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">extend(compute_cells(blob))</span>
<a id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">ExtendedMatrix(extended_matrix)</span>
</code></pre></div></td></tr></table></div>
<h4 id="recover_matrix"><code>recover_matrix</code><a class="headerlink" href="#recover_matrix" title="Permanent link">&para;</a></h4>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-1"> 1</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-2"> 2</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-3"> 3</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-4"> 4</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-5"> 5</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-6"> 6</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-7"> 7</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-8"> 8</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-9"> 9</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-10">10</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-11">11</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-12">12</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-13">13</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-14">14</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-3-15">15</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">recover_matrix</span><span style="color: #f8f8f2">(cells_dict:</span> <span style="color: #f8f8f2">Dict[Tuple[BlobIndex,</span> <span style="color: #f8f8f2">CellID],</span> <span style="color: #f8f8f2">Cell],</span> <span style="color: #f8f8f2">blob_count:</span> <span style="color: #f8f8f2">uint64)</span> <span style="color: #ff4689">-&gt;</span> <span style="color: #f8f8f2">ExtendedMatrix:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span style="color: #f8f8f2">    </span><span style="color: #e6db74">&quot;&quot;&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span style="color: #e6db74">    Return the recovered ``ExtendedMatrix``.</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span style="color: #e6db74">    This helper demonstrates how to apply ``recover_all_cells``.</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span style="color: #e6db74">    The data structure for storing cells is implementation-dependent.</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span style="color: #e6db74">    &quot;&quot;&quot;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8"></a>    <span style="color: #f8f8f2">extended_matrix</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[]</span>
<a id="__codelineno-3-9" name="__codelineno-3-9"></a>    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">blob_index</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(blob_count):</span>
<a id="__codelineno-3-10" name="__codelineno-3-10"></a>        <span style="color: #f8f8f2">cell_ids</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[cell_id</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">b_index,</span> <span style="color: #f8f8f2">cell_id</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">cells_dict</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">keys()</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">b_index</span> <span style="color: #ff4689">==</span> <span style="color: #f8f8f2">blob_index]</span>
<a id="__codelineno-3-11" name="__codelineno-3-11"></a>        <span style="color: #f8f8f2">cells</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[cells_dict[(blob_index,</span> <span style="color: #f8f8f2">cell_id)]</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">cell_id</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">cell_ids]</span>
<a id="__codelineno-3-12" name="__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13"></a>        <span style="color: #f8f8f2">all_cells_for_row</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">recover_all_cells(cell_ids,</span> <span style="color: #f8f8f2">cells)</span>
<a id="__codelineno-3-14" name="__codelineno-3-14"></a>        <span style="color: #f8f8f2">extended_matrix</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">extend(all_cells_for_row)</span>
<a id="__codelineno-3-15" name="__codelineno-3-15"></a>    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">ExtendedMatrix(extended_matrix)</span>
</code></pre></div></td></tr></table></div>
<h4 id="get_data_column_sidecars"><code>get_data_column_sidecars</code><a class="headerlink" href="#get_data_column_sidecars" title="Permanent link">&para;</a></h4>
<div class="highlight" style="background: #272822"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-1"> 1</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-2"> 2</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-3"> 3</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-4"> 4</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-5"> 5</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-6"> 6</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-7"> 7</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-8"> 8</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-9"> 9</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-10">10</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-11">11</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-12">12</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-13">13</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-14">14</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-15">15</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-16">16</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-17">17</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-18">18</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-19">19</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-20">20</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-21">21</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-22">22</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-23">23</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-24">24</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-25">25</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-26">26</a></span>
<span style="color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px;"><a href="#__codelineno-4-27">27</a></span></pre></div></td><td class="code"><div><pre style="line-height: 125%;"><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">get_data_column_sidecars</span><span style="color: #f8f8f2">(signed_block:</span> <span style="color: #f8f8f2">SignedBeaconBlock,</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a>                             <span style="color: #f8f8f2">blobs:</span> <span style="color: #f8f8f2">Sequence[Blob])</span> <span style="color: #ff4689">-&gt;</span> <span style="color: #f8f8f2">Sequence[DataColumnSidecar]:</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a>    <span style="color: #f8f8f2">signed_block_header</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">compute_signed_block_header(signed_block)</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a>    <span style="color: #f8f8f2">block</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">signed_block</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">message</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a>    <span style="color: #f8f8f2">kzg_commitments_inclusion_proof</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">compute_merkle_proof(</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>        <span style="color: #f8f8f2">block</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">body,</span>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a>        <span style="color: #f8f8f2">get_generalized_index(BeaconBlockBody,</span> <span style="color: #e6db74">&#39;blob_kzg_commitments&#39;</span><span style="color: #f8f8f2">),</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a>    <span style="color: #f8f8f2">)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a>    <span style="color: #f8f8f2">cells_and_proofs</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[compute_cells_and_kzg_proofs(blob)</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">blob</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">blobs]</span>
<a id="__codelineno-4-10" name="__codelineno-4-10"></a>    <span style="color: #f8f8f2">blob_count</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">len(blobs)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11"></a>    <span style="color: #f8f8f2">cells</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[cells_and_proofs[i][</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(blob_count)]</span>
<a id="__codelineno-4-12" name="__codelineno-4-12"></a>    <span style="color: #f8f8f2">proofs</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[cells_and_proofs[i][</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(blob_count)]</span>
<a id="__codelineno-4-13" name="__codelineno-4-13"></a>    <span style="color: #f8f8f2">sidecars</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[]</span>
<a id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">column_index</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(NUMBER_OF_COLUMNS):</span>
<a id="__codelineno-4-15" name="__codelineno-4-15"></a>        <span style="color: #f8f8f2">column</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">DataColumn([cells[row_index][column_index]</span>
<a id="__codelineno-4-16" name="__codelineno-4-16"></a>                             <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">row_index</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(blob_count)])</span>
<a id="__codelineno-4-17" name="__codelineno-4-17"></a>        <span style="color: #f8f8f2">kzg_proof_of_column</span> <span style="color: #ff4689">=</span> <span style="color: #f8f8f2">[proofs[row_index][column_index]</span>
<a id="__codelineno-4-18" name="__codelineno-4-18"></a>                               <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">row_index</span> <span style="color: #ff4689">in</span> <span style="color: #f8f8f2">range(blob_count)]</span>
<a id="__codelineno-4-19" name="__codelineno-4-19"></a>        <span style="color: #f8f8f2">sidecars</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">append(DataColumnSidecar(</span>
<a id="__codelineno-4-20" name="__codelineno-4-20"></a>            <span style="color: #f8f8f2">index</span><span style="color: #ff4689">=</span><span style="color: #f8f8f2">column_index,</span>
<a id="__codelineno-4-21" name="__codelineno-4-21"></a>            <span style="color: #f8f8f2">column</span><span style="color: #ff4689">=</span><span style="color: #f8f8f2">column,</span>
<a id="__codelineno-4-22" name="__codelineno-4-22"></a>            <span style="color: #f8f8f2">kzg_commitments</span><span style="color: #ff4689">=</span><span style="color: #f8f8f2">block</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">body</span><span style="color: #ff4689">.</span><span style="color: #f8f8f2">blob_kzg_commitments,</span>
<a id="__codelineno-4-23" name="__codelineno-4-23"></a>            <span style="color: #f8f8f2">kzg_proofs</span><span style="color: #ff4689">=</span><span style="color: #f8f8f2">kzg_proof_of_column,</span>
<a id="__codelineno-4-24" name="__codelineno-4-24"></a>            <span style="color: #f8f8f2">signed_block_header</span><span style="color: #ff4689">=</span><span style="color: #f8f8f2">signed_block_header,</span>
<a id="__codelineno-4-25" name="__codelineno-4-25"></a>            <span style="color: #f8f8f2">kzg_commitments_inclusion_proof</span><span style="color: #ff4689">=</span><span style="color: #f8f8f2">kzg_commitments_inclusion_proof,</span>
<a id="__codelineno-4-26" name="__codelineno-4-26"></a>        <span style="color: #f8f8f2">))</span>
<a id="__codelineno-4-27" name="__codelineno-4-27"></a>    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">sidecars</span>
</code></pre></div></td></tr></table></div>
<h2 id="custody">Custody<a class="headerlink" href="#custody" title="Permanent link">&para;</a></h2>
<h3 id="custody-requirement">Custody requirement<a class="headerlink" href="#custody-requirement" title="Permanent link">&para;</a></h3>
<p>Each node downloads and custodies a minimum of <code>CUSTODY_REQUIREMENT</code> subnets per slot. The particular subnets that the node is required to custody are selected pseudo-randomly (more on this below).</p>
<p>A node <em>may</em> choose to custody and serve more than the minimum honesty requirement. Such a node explicitly advertises a number greater than <code>CUSTODY_REQUIREMENT</code> via the peer discovery mechanism -- for example, in their ENR (e.g. <code>custody_subnet_count: 4</code> if the node custodies <code>4</code> subnets each slot) -- up to a <code>DATA_COLUMN_SIDECAR_SUBNET_COUNT</code> (i.e. a super-full node).</p>
<p>A node stores the custodied columns for the duration of the pruning period and responds to peer requests for samples on those columns.</p>
<h3 id="public-deterministic-selection">Public, deterministic selection<a class="headerlink" href="#public-deterministic-selection" title="Permanent link">&para;</a></h3>
<p>The particular columns that a node custodies are selected pseudo-randomly as a function (<code>get_custody_columns</code>) of the node-id and custody size -- importantly this function can be run by any party as the inputs are all public.</p>
<p><em>Note</em>: increasing the <code>custody_size</code> parameter for a given <code>node_id</code> extends the returned list (rather than being an entirely new shuffle) such that if <code>custody_size</code> is unknown, the default <code>CUSTODY_REQUIREMENT</code> will be correct for a subset of the node's custody.</p>
<h2 id="peer-discovery">Peer discovery<a class="headerlink" href="#peer-discovery" title="Permanent link">&para;</a></h2>
<p>At each slot, a node needs to be able to readily sample from <em>any</em> set of columns. To this end, a node SHOULD find and maintain a set of diverse and reliable peers that can regularly satisfy their sampling demands.</p>
<p>A node runs a background peer discovery process, maintaining at least <code>TARGET_NUMBER_OF_PEERS</code> of various custody distributions (both <code>custody_size</code> and column assignments). The combination of advertised <code>custody_size</code> size and public node-id make this readily and publicly accessible.</p>
<p><code>TARGET_NUMBER_OF_PEERS</code> should be tuned upward in the event of failed sampling.</p>
<p><em>Note</em>: while high-capacity and super-full nodes are high value with respect to satisfying sampling requirements, a node SHOULD maintain a distribution across node capacities as to not centralize the p2p graph too much (in the extreme becomes hub/spoke) and to distribute sampling load better across all nodes.</p>
<p><em>Note</em>: A DHT-based peer discovery mechanism is expected to be utilized in the above. The beacon-chain network currently utilizes discv5 in a similar method as described for finding peers of particular distributions of attestation subnets. Additional peer discovery methods are valuable to integrate (e.g., latent peer discovery via libp2p gossipsub) to add a defense in breadth against one of the discovery methods being attacked.</p>
<h2 id="extended-data">Extended data<a class="headerlink" href="#extended-data" title="Permanent link">&para;</a></h2>
<p>In this construction, we extend the blobs using a one-dimensional erasure coding extension. The matrix comprises maximum <code>MAX_BLOBS_PER_BLOCK</code> rows and fixed <code>NUMBER_OF_COLUMNS</code> columns, with each row containing a <code>Blob</code> and its corresponding extension. <code>compute_extended_matrix</code> demonstrates the relationship between blobs and custom type <code>ExtendedMatrix</code>.</p>
<h2 id="column-gossip">Column gossip<a class="headerlink" href="#column-gossip" title="Permanent link">&para;</a></h2>
<h3 id="parameters">Parameters<a class="headerlink" href="#parameters" title="Permanent link">&para;</a></h3>
<p>For each column -- use <code>data_column_sidecar_{subnet_id}</code> subnets, where <code>subnet_id</code> can be computed with the <code>compute_subnet_for_data_column_sidecar(column_index: ColumnIndex)</code> helper. The sidecars can be computed with the <code>get_data_column_sidecars(signed_block: SignedBeaconBlock, blobs: Sequence[Blob])</code> helper.</p>
<p>To custody a particular column, a node joins the respective gossip subnet. Verifiable samples from their respective column are gossiped on the assigned subnet.</p>
<h2 id="peer-sampling">Peer sampling<a class="headerlink" href="#peer-sampling" title="Permanent link">&para;</a></h2>
<p>A node SHOULD maintain a diverse set of peers for each column and each slot by verifying responsiveness to sample queries. At each slot, a node makes <code>SAMPLES_PER_SLOT</code> queries for samples from their peers via <code>DataColumnSidecarsByRoot</code> request. A node utilizes <code>get_custody_columns</code> helper to determine which peer(s) to request from. If a node has enough good/honest peers across all rows and columns, this has a high chance of success.</p>
<h2 id="peer-scoring">Peer scoring<a class="headerlink" href="#peer-scoring" title="Permanent link">&para;</a></h2>
<p>Due to the deterministic custody functions, a node knows exactly what a peer should be able to respond to. In the event that a peer does not respond to samples of their custodied rows/columns, a node may downscore or disconnect from a peer.</p>
<h2 id="reconstruction-and-cross-seeding">Reconstruction and cross-seeding<a class="headerlink" href="#reconstruction-and-cross-seeding" title="Permanent link">&para;</a></h2>
<p>If the node obtains 50%+ of all the columns, they can reconstruct the full data matrix via <code>recover_matrix</code> helper.</p>
<p>If a node fails to sample a peer or fails to get a column on the column subnet, a node can utilize the Req/Resp message to query the missing column from other peers.</p>
<p>Once the node obtain the column, the node SHOULD send the missing columns to the column subnets.</p>
<p><em>Note</em>: A node always maintains a matrix view of the rows and columns they are following, able to cross-reference and cross-seed in either direction.</p>
<p><em>Note</em>: There are timing considerations to analyze -- at what point does a node consider samples missing and choose to reconstruct and cross-seed.</p>
<p><em>Note</em>: There may be anti-DoS and quality-of-service considerations around how to send samples and consider samples -- is each individual sample a message or are they sent in aggregate forms.</p>
<h2 id="das-providers">DAS providers<a class="headerlink" href="#das-providers" title="Permanent link">&para;</a></h2>
<p>A DAS provider is a consistently-available-for-DAS-queries, super-full (or high capacity) node. To the p2p, these look just like other nodes but with high advertised capacity, and they should generally be able to be latently found via normal discovery.</p>
<p>DAS providers can also be found out-of-band and configured into a node to connect to directly and prioritize. Nodes can add some set of these to their local configuration for persistent connection to bolster their DAS quality of service.</p>
<p>Such direct peering utilizes a feature supported out of the box today on all nodes and can complement (and reduce attackability and increase quality-of-service) alternative peer discovery mechanisms.</p>
<h2 id="a-note-on-fork-choice">A note on fork choice<a class="headerlink" href="#a-note-on-fork-choice" title="Permanent link">&para;</a></h2>
<p><em>Fork choice spec TBD, but it will just be a replacement of <code>is_data_available()</code> call in Deneb with column sampling instead of full download. Note the <code>is_data_available(slot_N)</code> will likely do a <code>-1</code> follow distance so that you just need to check the availability of slot <code>N-1</code> for slot <code>N</code> (starting with the block proposer of <code>N</code>).</em></p>
<p>The fork choice rule (essentially a DA filter) is <em>orthogonal to a given DAS design</em>, other than the efficiency of a particular design impacting it.</p>
<p>In any DAS design, there are probably a few degrees of freedom around timing, acceptability of short-term re-orgs, etc. </p>
<p>For example, the fork choice rule might require validators to do successful DAS on slot <code>N</code> to be able to include block of slot <code>N</code> in its fork choice. That's the tightest DA filter. But trailing filters are also probably acceptable, knowing that there might be some failures/short re-orgs but that they don't hurt the aggregate security. For example, the rule could be — DAS must be completed for slot N-1 for a child block in N to be included in the fork choice.</p>
<p>Such trailing techniques and their analysis will be valuable for any DAS construction. The question is — can you relax how quickly you need to do DA and in the worst case not confirm unavailable data via attestations/finality, and what impact does it have on short-term re-orgs and fast confirmation rules.</p>
<h2 id="faqs">FAQs<a class="headerlink" href="#faqs" title="Permanent link">&para;</a></h2>
<h3 id="row-blob-custody">Row (blob) custody<a class="headerlink" href="#row-blob-custody" title="Permanent link">&para;</a></h3>
<p>In the one-dimension construction, a node samples the peers by requesting the whole <code>DataColumn</code>. In reconstruction, a node can reconstruct all the blobs by 50% of the columns. Note that nodes can still download the row via <code>blob_sidecar_{subnet_id}</code> subnets.</p>
<p>The potential benefits of having row custody could include:</p>
<ol>
<li>Allow for more "natural" distribution of data to consumers -- e.g., roll-ups -- but honestly, they won't know a priori which row their blob is going to be included in in the block, so they would either need to listen to all rows or download a particular row after seeing the block. The former looks just like listening to column [0, N)  and the latter is req/resp instead of gossiping.</li>
<li>Help with some sort of distributed reconstruction. Those with full rows can compute extensions and seed missing samples to the network. This would either need to be able to send individual points on the gossip or would need some sort of req/resp faculty, potentially similar to an <code>IHAVEPOINTBITFIELD</code> and <code>IWANTSAMPLE</code>.</li>
</ol>
<p>However, for simplicity, we don't assign row custody assignments to nodes in the current design.</p>
<h3 id="subnet-stability">Subnet stability<a class="headerlink" href="#subnet-stability" title="Permanent link">&para;</a></h3>
<p>To start with a simple, stable backbone, for now, we don't shuffle the subnet assignments via the deterministic custody selection helper <code>get_custody_columns</code>. However, staggered rotation likely needs to happen on the order of the pruning period to ensure subnets can be utilized for recovery. For example, introducing an <code>epoch</code> argument allows the function to maintain stability over many epochs.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/ethereum/consensus-specs" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "search"], "search": "../../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.407015b8.min.js"></script>
      
    
  </body>
</html>